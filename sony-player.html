<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>HLS Player Embed</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Plyr -->
<link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css">
<script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>

<!-- HLS -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
/* ===============================
   ORIGINAL FAST BASE (RESTORED)
   =============================== */
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    background: #000;
    overflow: hidden;
}

/* Player fills iframe */
.plyr {
    width: 100%;
    height: 100%;
    border-radius: 0;
}

/* Subtle polish ONLY (no effects) */
video {
    width: 100%;
    height: 100%;
    background: #000;
}

/* Slightly sharper controls, zero cost */
.plyr__control {
    font-smooth: always;
    -webkit-font-smoothing: antialiased;
}
</style>
</head>

<body>

<!-- VIDEO (UNCHANGED) -->
<video id="player" playsinline>
    <source src="" type="application/vnd.apple.mpegurl" />
    <a href="" download>Download</a>
</video>

<!-- CONFIG (UNCHANGED) -->
<script type="application/json" id="embed-config">{
    "autoplay": false,
    "muted": false,
    "hidecontrols": false
}</script>

<!-- ===============================
     YOUR ORIGINAL JS â€” RESTORED
     =============================== -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const video = document.getElementById('player');
    let hasUserInteracted = false;
    let isAutoplayMuted = false;
    let autoplayAttempted = false;

    const configElement = document.getElementById('embed-config');
    const config = JSON.parse(configElement.textContent);

    const plyrOptions = {
        captions: { active: true, update: true, language: 'en' }
    };

    if (config.hidecontrols) {
        plyrOptions.controls = [];
    } else {
        plyrOptions.controls = [
            'play-large',
            'play',
            'progress',
            'current-time',
            'mute',
            'volume',
            'fullscreen'
        ];
    }

    if (config.muted) {
        plyrOptions.muted = true;
    }

    const player = new Plyr(video, plyrOptions);

    const videoUrl = '';
    let hls = null;

    if (Hls.isSupported()) {
        hls = new Hls();
        hls.loadSource(videoUrl);
        hls.attachMedia(video);

        hls.on(Hls.Events.MANIFEST_PARSED, function() {
            if (config.autoplay) {
                setTimeout(attemptSmartAutoplay, 100);
            } else if (config.muted) {
                player.muted = true;
                video.muted = true;
            }
        });
    } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        video.src = videoUrl;

        video.addEventListener('loadedmetadata', function() {
            if (config.autoplay) {
                setTimeout(attemptSmartAutoplay, 100);
            } else if (config.muted) {
                player.muted = true;
                video.muted = true;
            }
        });
    }

    async function attemptSmartAutoplay() {
        if (autoplayAttempted) return;
        autoplayAttempted = true;

        try {
            player.muted = false;
            await player.play();
            return;
        } catch {}

        try {
            player.muted = true;
            isAutoplayMuted = true;
            await player.play();
        } catch {}
    }
});
</script>

</body>
</html>
